# Истокъ – сервис ретроконверсии архивных документов

Сервис извлечения и индексирования информации из образов архивных документов (ретроконверсия), разработанный в рамках конкурса **«Лидеры Цифровой Трансформации 2025»**, задача №9, заказчик - Главархив Москвы.

![Hackathon](https://img.shields.io/badge/ЛЦТ-2025-blue)
![Backend](https://img.shields.io/badge/Backend-Go-00ADD8)
![Frontend](https://img.shields.io/badge/Frontend-React%20%2B%20TS-61DAFB)
![ML](https://img.shields.io/badge/ML-PaddleOCR%20%2B%20OpenCV-orange)
![DB](https://img.shields.io/badge/DB-PostgreSQL-336791)
![Storage](https://img.shields.io/badge/Object%20Storage-MinIO-critical)
![Queue](https://img.shields.io/badge/Queue-Apache%20Kafka-black)
![Deploy](https://img.shields.io/badge/Deploy-Docker-2496ED)

[Документация](Сопроводительная_документация_Команда_№12.pdf)

[Презентация](https://drive.google.com/file/d/1HnmtSc2G_DOjVWpGNFduF5JX7xM0_nT3/view?usp=sharing)

[Frontend-репозиторий](https://github.com/exsec-dev/istok)

## О проекте

Архивы работают с большими массивами оцифрованных документов (в т.ч. дореволюционные метрические книги), которые требуют трудоемкой ручной расшифровки и поиска. Сервис автоматизирует ретроконверсию: извлекает текст из образов, сохраняет структуру документа и координаты блоков, позволяет верифицировать результат и экспортировать данные в удобных форматах.

---

## Основной функционал

- Загрузка образов документов (JPG/JPEG, TIFF) в составе одного архивного дела.
- Просмотр списка документов: архивный шифр, название, статус обработки, дата загрузки, фильтры и поиск.
- Постраничный просмотр: оригинальное изображение + распознанный текст в двухпанельном интерфейсе.
- Подсветка текстовых блоков на изображении, цветовая индикация уровней уверенности (confidence).
- Режимы «Просмотр» и «Редактирование», ручная правка распознанного текста.
- Поиск по подстроке в распознанном тексте страницы.
- Экспорт результатов распознавания в структурированные форматы (CSV, XLSX, XML).
- Полностью офлайн-развертываемая архитектура.

Часть продвинутых функций (атрибутивное распознавание, активное дообучение по правкам, полнотекстовый поиск по всему документу) заложены в архитектуру и выделены как направления развития.

---

## Установка и запуск

### Минимальные требования

- **OS:** Linux x86_64  
- **ПО:**  
  - Docker Engine  
  - Docker Compose v2  
- **Ресурсы (минимум):**
  - CPU: ≥ 4 vCPU
  - RAM: ≥ 8 ГБ
  - Диск: ≥ 40–60 ГБ SSD свободного места

### Рекомендуемая конфигурация:

- CPU: ≥ 4 vCPU (лучше 8 vCPU)
- RAM: ≥ 8 ГБ (рекомендуется 16 ГБ)
- SSD: от 40–60 ГБ (рекомендуется от 100 ГБ)

### Быстрый старт

**1. Клонируйте репозиторий** (представлена ссылка на ориг. репозиторий):
  
 ```bash
 git clone https://github.com/kirenate/lct.git
 cd lct/pkg
 ```
   
**2. Скачайте веса модели OCR и поместите их в каталог .data на хосте:**
   
  ```bash
  mkdir -p .data
  # скопируйте файлы весов PaddleOCR в lct/pkg/.data
  ```

**3. Настройте переменные окружения backend-сервиса:**

  ```bash
  pkg/backend/.env
  ```

  Заполните значения (подключение к PostgreSQL, S3/MinIO, Kafka, ML-сервису и т.д.) согласно вашей среде.

**4. Запуск через Docker Compose:**

  ```bash
  docker compose -f docker-compose-nossl.yaml pull
  docker compose -f docker-compose-nossl.yaml up -d --build
  ```

  После успешного запуска веб-интерфейс будет доступен по HTTP-адресу и порту, указанным в docker-compose-nossl.yaml.

---

## Технологии и архитектура
### Технологический стек

- Frontend: *React + TypeScript (SPA), SCSS-модули, REST-клиент для взаимодействия с backend*

- Backend: *Go, REST API, подписанные ссылки для доступа к изображениям в объектном хранилище*

- ML-контур: *Python + FastAPI, OpenCV, PaddleOCR, NumPy*

### Инфраструктура

- NGINX: *reverse-proxy, TLS-тэрминация, маршрутизация /api, лимиты на загрузку*

- PostgreSQL: *реляционные метаданные (документы, страницы, координаты блоков, уровни уверенности)*

- S3-совместимое хранилище (MinIO): *исходные образы и артефакты*

- Apache Kafka: *очередь задач на обработку документов*

- Docker / Docker Compose: *оркестрация и офлайн-развертывание в закрытом контуре*

### Архитектура решения

<img width="951" height="424" alt="Screenshot 2025-12-12 175023" src="https://github.com/user-attachments/assets/e53fda2d-b5ad-4dc2-bc4c-4754a79e4dc7" />

---

## Команда

Команда «MISIS_MSc», НИТУ МИСИС, г. Москва.

| Роль	| Участник	| Контакты |
| ------------- | ------------- | ----- |
| Капитан команды, Frontend |	Екатерина Прожирко |	GitHub: exsec-dev, Telegram: @exsec2 |
| Backend |	Ольга Захаржевская |	GitHub: kirenate, Telegram: @eKiren |
| ML-инженер (OCR, обучение)	| Полина Кибиткина	| Telegram: @paulline_k |
| ML-инженер (разметка) |	Артем Соседка |	Telegram: @dabiteof87 |
| Дизайн, UI/UX |	Мария Ковалева |	Telegram: @creamsoda0 |

---

## Демонстрация

YouTube-видео с демонстрацией работы сервиса:

<a href="http://www.youtube.com/watch?feature=player_embedded&v=Orhw10bVGvE
" target="_blank"><img src="http://img.youtube.com/vi/Orhw10bVGvE/0.jpg" 
alt="Демонстрация" width="240" height="180" border="10" /></a>

Скриншоты основных экранов:

<img width="1000" height="613" alt="image_2025-12-12_18-19-54" src="https://github.com/user-attachments/assets/ea45975b-64c1-4d45-b9bb-2c37d94046ba" />
<img width="1000" height="701" alt="image_2025-12-12_18-19-54 (2)" src="https://github.com/user-attachments/assets/a2ab5c1d-20c8-46f8-8bda-f87d342a70d6" />
<img width="1000" height="776" alt="image_2025-12-12_18-19-54 (3)" src="https://github.com/user-attachments/assets/44a62b9a-6760-4c2f-b1dd-7dcb86604d8f" />
<img width="1000" height="693" alt="image_2025-12-12_18-19-55" src="https://github.com/user-attachments/assets/50d9da1a-1be0-4b58-b3f6-aeaca8dcbb47" />

---

## Ключевые эффекты от внедрения

- Снижение нагрузки на сотрудников архивов за счет автоматизации рукописного и печатного OCR.

- Ускорение подготовки ответов на архивные запросы граждан и исследователей.

- Повышение доступности исторических данных и содействие развитию генеалогических и исторических исследований.

---

## Планы по развитию:

- Повышение качества распознавания: *расширение корпуса размеченных дореволюционных текстов, регулярное дообучение моделей на новых данных и пользовательских правках*

- Внедрение атрибутивного распознавания: *выделение ФИО, дат, адресов, архивных шифров с привязкой к координатам на изображении*

- Добавление постобработки с помощью LLM: *нормализация дореформенной орфографии, исправление типовых ошибок распознавания, приведение дат и имен к целевым форматам*

- Расширение функций для продакшн-сценариев: *ролевая модель доступа и журнал правок, полнотекстовый поиск по документам и индексирование на уровне архива*

---

## Лицензия

Проект распространяется под лицензией MIT.
